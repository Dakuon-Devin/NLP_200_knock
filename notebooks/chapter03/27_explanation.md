# 問題27: 内部リンクの除去 - 解説

## 問題の概要
この問題では、問題26で実装した強調マークアップの除去に加えて、MediaWikiの内部リンクマークアップも除去する処理を実装します。

## MediaWikiの内部リンクマークアップの種類
MediaWikiでは、内部リンク（同じWiki内の他のページへのリンク）は以下の形式で記述されます：

1. **基本形式**：`[[リンク先]]`
   - 例：`[[イギリス]]` → 「イギリス」というテキストが表示され、「イギリス」のページへのリンクになります。

2. **表示テキスト指定形式**：`[[リンク先|表示テキスト]]`
   - 例：`[[イギリス|英国]]` → 「英国」というテキストが表示され、「イギリス」のページへのリンクになります。

## 解法のポイント

### 1. 正規表現を使用した内部リンクマークアップの除去
内部リンクマークアップを除去するには、2つのパターンを順に処理します。

```python
# パターン1: [[リンク先|表示テキスト]] → 表示テキスト
text = re.sub(r"\[\[(?:[^|\]]+)\|([^\]]+)\]\]", r"\1", text)

# パターン2: [[リンク先]] → リンク先
text = re.sub(r"\[\[([^\]]+)\]\]", r"\1", text)
```

### 2. 処理の順序
内部リンクマークアップの処理順序も重要です。まず `[[リンク先|表示テキスト]]` の形式を処理し、次に `[[リンク先]]` の形式を処理します。これにより、表示テキストが指定されている場合はそれを優先して抽出できます。

### 3. 強調マークアップと内部リンクマークアップの組み合わせ
強調マークアップと内部リンクマークアップの両方を除去する場合、どちらを先に処理しても結果は同じになることが多いですが、両方の処理を行うことが重要です。

```python
def remove_markup(text):
    # 強調マークアップを除去
    text = remove_emphasis_markup(text)
    
    # 内部リンクマークアップを除去
    text = remove_internal_links(text)
    
    return text
```

## 実装上の注意点

1. **入れ子になったマークアップ**：
   内部リンクの中に強調マークアップが含まれている場合や、強調マークアップの中に内部リンクが含まれている場合があります。

2. **複雑なリンク形式**：
   実際のWikipediaの記事では、より複雑なリンク形式（例：`[[リンク先#セクション|表示テキスト]]`）が使用されることがあります。

3. **特殊なリンク形式**：
   カテゴリリンク（`[[Category:カテゴリ名]]`）やファイルリンク（`[[File:ファイル名]]`）など、特殊なリンク形式もあります。これらは通常、別の処理が必要です。

## 正規表現の解説

- `r"\[\[(?:[^|\]]+)\|([^\]]+)\]\]"`：
  - `\[\[` : 文字列 `[[` にマッチ
  - `(?:[^|\]]+)` : パイプ記号（`|`）または閉じ括弧（`]`）以外の1つ以上の文字にマッチし、グループ化しない（`?:`）
  - `\|` : パイプ記号（`|`）にマッチ
  - `([^\]]+)` : 閉じ括弧（`]`）以外の1つ以上の文字にマッチし、グループ化（`()`）
  - `\]\]` : 文字列 `]]` にマッチ

- `r"\[\[([^\]]+)\]\]"`：
  - `\[\[` : 文字列 `[[` にマッチ
  - `([^\]]+)` : 閉じ括弧（`]`）以外の1つ以上の文字にマッチし、グループ化（`()`）
  - `\]\]` : 文字列 `]]` にマッチ

## 発展的な内容
この問題は、Wikipediaの記事からより読みやすいテキストを抽出するための重要なステップです。次の問題では、さらに複雑なマークアップ（外部リンク、HTMLタグなど）の除去に取り組むことになるでしょう。
